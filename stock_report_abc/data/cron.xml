<odoo>
  <data noupdate="0">
    <!-- (1) SNAPSHOT PRIMERO: 05:05 UTC = 00:05 Ecuador -->
    <record id="ir_cron_abc_monthly_snapshot" model="ir.cron">
      <field name="name">ABC: Guardar Historial Mensual</field>
      <field name="model_id" ref="product.model_product_product"/>
      <field name="state">code</field>
      <field name="code">model.cron_snapshot_monthly_abc(batch_size=200)</field>
      <field name="user_id" ref="base.user_admin"/>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="active">True</field>
      <field name="nextcall"
             eval="(DateTime.now().replace(hour=5, minute=5, second=0, microsecond=0) + timedelta(days=1)).strftime('%Y-%m-%d %H:%M:%S')"/>
    </record>

    <!-- (2) LUEGO UPDATE DE PERÍODO: 05:15 UTC = 00:15 Ecuador -->
    <record id="ir_cron_update_abc_reference_period" model="ir.cron">
      <field name="name">ABC: Actualizar período de referencia</field>
      <field name="model_id" ref="model_abc_classification_config"/>
      <field name="state">code</field>
      <field name="code">model.cron_update_reference_period()</field>
      <field name="user_id" ref="base.user_admin"/>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="active">True</field>
      <field name="nextcall"
             eval="(DateTime.now().replace(hour=5, minute=15, second=0, microsecond=0) + timedelta(days=1)).strftime('%Y-%m-%d %H:%M:%S')"/>
    </record>

    <!-- (3) AL FINAL, RE-CALCULO ABC: 05:25 UTC = 00:25 Ecuador -->
    <record id="ir_cron_abc_one_shot_daily" model="ir.cron">
      <field name="name">ABC: Clasificación por lotes (75)</field>
      <field name="model_id" ref="product.model_product_product"/>
      <field name="state">code</field>
      <field name="user_id" ref="base.user_admin"/>
      <field name="code">model.cron_run_abc_single_loop(batch_size=200, sleep_seconds=3)</field>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="active">True</field>
      <field name="nextcall"
             eval="(DateTime.now().replace(hour=5, minute=25, second=0, microsecond=0) + timedelta(days=1)).strftime('%Y-%m-%d %H:%M:%S')"/>
    </record>
        <record id="ir_cron_abc_run_cutoff_snapshot" model="ir.cron">
          <field name="name">ABC: Ejecutar flujo completo con corte específico</field>
          <field name="model_id" ref="product.model_product_product"/>
          <field name="state">code</field>
          <field name="user_id" ref="base.user_admin"/>
          <!-- Puedes cambiar los valores de año/mes cuando lo actives -->
          <field name="code">model.action_run_abc_for_cutoff_and_snapshot(year=2025, month=7, batch_size=200, sleep_seconds=3)</field>
          <field name="interval_number">1</field>
          <field name="interval_type">days</field>
          <field name="active">False</field>
          <field name="nextcall"
                 eval="(DateTime.now().replace(hour=5, minute=40, second=0, microsecond=0) + timedelta(days=1)).strftime('%Y-%m-%d %H:%M:%S')"/>
    </record>
  </data>
</odoo>
